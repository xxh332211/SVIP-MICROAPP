<!--pages-sh/pages/shForm/shForm.wxml-->
<privacy-popup></privacy-popup>
<view class="container">
  <view class="err-tips" hidden="{{hideErrTips}}">{{errTips}}</view>
  <view class="box">
    <view class="item">
      <text class="title">订单编号</text>
      <input class="ipt" type="text" style="width:440rpx" bindinput="orderInpChange" value="{{orderNum}}" placeholder="请输入绿单子订单编号" maxlength="20"
        bindblur="searchOrderInfo" />
      <image class="scan-img" src="https://img.51jiabo.com/3fb25a09-36ce-440b-8a89-42674d4e5a8f.png" catchtap="wxScan">
      </image>
    </view>
    <view class="item">
      <text class="title">买家姓名</text>
      <input type="text" class="ipt short-ipt" value="{{name}}" placeholder="如何称呼" maxlength="10" bindinput="nameInpChange" />
      <radio-group class="radio-box" bindchange="radioHandle">
        <label>
          <radio checked="{{genderId == 1}}" value="1"></radio>
          <text>先生</text>
        </label>
        <label>
          <radio checked="{{genderId == 2}}" value="2"></radio>
          <text>女士</text>
        </label>
      </radio-group>
    </view>
    <view class="item">
      <text class="title tit-after">买家电话</text>
      <input type="text" class="ipt" value="{{phoneNum}}" placeholder="请输入手机号" maxlength="11" bindinput="phoneInpChange" bindfocus="phoneInpFocus"/>
    </view>
    <view class="item">
      <text class="title">商户品牌</text>
      <input type="text" class="ipt" value="{{brandName}}" placeholder="请输入绿单子上商户品牌名称" maxlength="20" bindinput="brandInpChange" />
    </view>
  </view>

  <view class="box">
    <!-- 选择城市 -->
    <view class="item item2">
      <text class="title tit-after">订单城市</text>
      <text class="choose-text" bindtap="showCityPopup">{{curCity.city_name || '请选择'}} ></text>
    </view>
    <!-- 上传图片 -->
    <view class="item item3">
      <view class="title tit-after">订单图片</view>
      <view class="upload" bindtap="uploadPhoto">
        <image class="upload-icon" src="https://img.51jiabo.com/3af5e41c-09cc-4bc9-9281-bbeec939ceff.png"></image>
        <view class="upload-text">可上传1张图片</view>
        <image wx:if="{{uploadedImgUrl}}" class="uploaded-img" src="{{uploadedImgUrl}}"></image>
        <image wx:if="{{uploadedImgUrl}}" src="https://img.51jiabo.com/16452d3b-51f5-4223-9539-d3c3d30feea4.png" class="del-img" catchtap="delImg"></image>
      </view>
    </view>
    <!-- 选择退款类型 -->
    <view class="item item2">
      <text class="title tit-after">退款类型</text>
      <text class="choose-text" bindtap="showRefundTypePopup">{{refundType.text || '请选择'}} ></text>
    </view>
    <!-- 选择退款原因 -->
    <view class="item item2">
      <text class="title tit-after">退款原因</text>
      <text class="choose-text" bindtap="showRefundReasonPopup">{{refundReason.text || '请选择'}} ></text>
    </view>
    <!-- 问题描述 -->
    <view class="item item3">
      <text class="title">问题描述</text>
      <textarea style="font-size:28rpx;" value="{{problemContent}}" maxlength="200" bindinput="problemInpChange"></textarea>
    </view>
  </view>

  <button bindtap="submit">提交申请</button>

  <!-- 弹框 -->
  <view class="cover" wx:if="{{showCover}}">
    <view class="inner-box">
      <image class="close-cover" src="https://img.51jiabo.com/16452d3b-51f5-4223-9539-d3c3d30feea4.png" catchtap="closePopup"></image>
      <!-- 选择城市 -->
      <block wx:if="{{chooseCityPopup}}">
        <view class="city-title">当前城市</view>
        <view class="cur-city">{{curCity.city_name || defaultCurCity}}</view>
        <view class="city-title">分站城市</view>
        <view class="city-list">
          <view class="city-item" wx:for="{{cityList}}" wx:key="id" catchtap="chooseCity" data-item="{{item}}">
            {{item.city_name}}</view>
        </view>
      </block>

      <!-- 选择退款原因 -->
      <block wx:if="{{chooseRefundReasonPopup}}">
        <radio-group class="reason-box">
          <label class="refund-reason-item" wx:for="{{refundReasonList}}" wx:key="id" data-item="{{item}}" bindtap="refundReasonChoose">
            <view class="reason-text">{{item.text}}</view>
            <radio class="reason-radio" checked="{{item.id === (refundReason?refundReason.id : 'false')}}"></radio>
          </label>
        </radio-group>
      </block>

      <!-- 选择退款类型 -->
      <block wx:if="{{chooseRefundTypePopup}}">
        <radio-group class="reason-box">
          <label class="refund-reason-item" wx:for="{{refundTypeList}}" wx:key="id" data-item="{{item}}" bindtap="refundTypeChoose">
            <view class="reason-text">{{item.text}}</view>
            <radio class="reason-radio" checked="{{item.id === (refundType?refundType.id : 'false')}}"></radio>
          </label>
        </radio-group>
      </block>
    </view>
  </view>
</view>